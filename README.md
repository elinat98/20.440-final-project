# Overview 

This repository contains code to analyze a network file generated by creating a drug, disease, protein, variant network using data from PharmGKB, Drug Target Commons (DTC), BioPlex and Binding DB. 

* PharmGKB: PharmGKB is a comprehensive pharmacogenomics resource that provides information on how genetic variation influences drug responses, including detailed drug–gene, drug–variant, and drug–disease associations. (Whirl-Carrillo, 2021)

* Drug Target Commons (DTC): Drug Target Commons is a community-driven database offering curated and standardized data on drug–target interactions, including binding affinity measurements and other key metrics for therapeutic targets. (Wishart, 2018)

* BioPlex: BioPlex provides large-scale proteomics data focused on protein–protein interactions, enabling the exploration of the complex networks that underpin cellular function. (Huttlin, 2015)

* Binding DB: Binding DB is a public repository that offers quantitative binding affinity data between proteins and small molecules, particularly useful for analyzing drug efficacy and biochemical interaction profiles. (Gilson, 2015)

Data from these databases were all processed and standardized to standard naming conventions (ie CHEMBL for drugs, and UniProt for proteins) and then combined into a heterogenous network using the python `networkx` package. Binding data between protein and drug (from DTC or Binding DB) when available was incorporated into weighted edges, either in the form of IC50, or Ki, and protein-protein interaction scores (pInt) from BioPlex was also incorporated as a weighted edge. 

# Data

Datasets and premade network file are stored in the `data` folder. Files that are `.tsv` or `.csv` files are raw data directly from the source (ie PharmGKB, or DTC), whereas `.json` files are premade dictionaries mapping entries of a dataset to a common identifier ie UniProt ID or CHEMBL ID. These were generated with separate data processessing scripts. The `network.gpickle` file was generated in python with the `networkx` package as a heterogenous network using data from the dataset files included in the `data` folder, using the `.json` dictionaries to map entries to common identifiers. 

# Installation and Running  
This guide explains how to set up your environment and run the network analysis code for a given network (saved in a .gpickle format)

## 1. Create a new Conda environment
Create a new Conda environment named "network_analysis" with Python 3.9 (or your preferred version)

  ```sh
conda create --name network_analysis python=3.9 -y
  ```

## 2. Activate the new environment
  ```sh
conda activate network_analysis
  ```
## 3. Install the required packages using Conda
  ```sh
 conda install -y networkx numpy matplotlib pandas pickle
 ```


## 4. Run the network analysis code for the given network.gpickle file 
```sh
python graph-network.py network.gpickle 
```

## 5. Examine the output files 
The code once executed will put out a `network-stats.txt` file with information on the number of nodes, edges, graph density, and average node degree as well as node type counts, edge relation counts, and data-set sepecific node counts as well as pairwise overlap between datasets. The script will also produce figures displaying the data in network-stats.txt such as `edge_relation_counts.png`, a histogram of edge relations types, `node_counts_by_type.png`, a histogram of node types, and `overlap_heatmap.png`, a heatmap showing overlap between datasets. 


## 6. Citations 
Wishart, D. S., Feunang, Y. D., Guo, A. C., Lo, E. J., Marcu, A., Grant, J. R., ... & Wilson, M. (2018). DrugBank 5.0: a major update to the DrugBank database for 2018. Nucleic Acids Research, 46(D1), D1074-D1082.

Gilson, M. K., Liu, T., Baitaluk, M., Nicola, G., Hwang, L., & Chong, J. (2016). BindingDB in 2015: A public database for medicinal chemistry, computational chemistry and systems pharmacology. Nucleic Acids Research, 44(D1), D1045-D1053.

Whirl-Carrillo, M., Huddart, R., Gong, L., Sangkuhl, K., Thorn, C. F., Whaley, R., & Klein, T. E. (2021). An evidence-based framework for evaluating pharmacogenomics knowledge for personalized medicine. Clinical Pharmacology & Therapeutics, 110(3), 563-572.

Huttlin EL, Ting L, Bruckner RJ, Gebreab F, Gygi MP, Szpyt J, Tam S, Zarraga G, Colby G, Baltier K, Dong R, Guarani V, Vaites LP, Ordureau A, Rad R, Erickson BK, Wühr M, Chick J, Zhai B, Kolippakkam D, Mintseris J, Obar RA, Harris T, Artavanis-Tsakonas S, Sowa ME, De Camilli P, Paulo JA, Harper JW, Gygi SP. The BioPlex Network: A Systematic Exploration of the Human Interactome. Cell. 2015 Jul 16;162(2):425-440. doi: 10.1016/j.cell.2015.06.043. PMID: 26186194; PMCID: PMC4617211.
